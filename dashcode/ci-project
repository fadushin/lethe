#!/bin/sh

PROJECT_NAME=Lethe
PROJECT_SUFFIX=.dcproj
PROJECT_CI=${PROJECT_NAME}${PROJECT_SUFFIX}-ci
PROJECT_CO=${PROJECT_NAME}-co${PROJECT_SUFFIX}
WDIR=$(dirname $0)
JS_ROOT=${WDIR}/../../javascript

if [ -e "${PROJECT_CO}" ] 
then
    ARCHIVE_FILE=${PROJECT_CO}-$(date +%Y.%m.%d-%H:%M:%S).tar.gz
    tar zcf archives/${ARCHIVE_FILE} ${PROJECT_CO}

    mvdir ${PROJECT_CO}/project/thirdparty/com.broofa ${JS_ROOT}/thirdparty/com.broofa
    mvdir ${PROJECT_CO}/project/thirdparty/ats.oka.nu ${JS_ROOT}/thirdparty/ats.oka.nu
    mvdir ${PROJECT_CO}/project/safari/jsolait ${JS_ROOT}/thirdparty/jsolait
    rm -rf ${PROJECT_CO}/project/mobile/jsolait
    mvdir ${PROJECT_CO}/project/foundation ${JS_ROOT}/foundation
    mvdir ${PROJECT_CO}/project/crypto ${JS_ROOT}/crypto

    mvdir ${PROJECT_CO} ${PROJECT_CI}
    
    echo "OK!! "
    echo "OK!! You may now submit your work in ${PROJECT_CI} to subversion"
    echo "OK!! "
else
    echo "ERROR!! "
    echo "ERROR!! You have not checked out ${PROJECT_NAME}!  Try running co-project first."
    echo "ERROR!! "
    exit 1
fi

